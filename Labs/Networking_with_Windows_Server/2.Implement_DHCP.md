# EXERCISE 1: PLAN A DHCP SERVER IMPLEMENTATION


## SCENARIO OVERVIEW
Contoso Corporation is opening three new North American branch offices:
- Houston
- Mexico City
- Portland

All offices connect back to the Toronto office.
No servers will be deployed in the branch offices.
TOR-SVR1 will be the PRIMARY DHCP server.

------------------------------------------------------------
## TASK 1: PLAN A DHCP SERVER IMPLEMENTATION
------------------------------------------------------------

### QUESTION 1
What scopes do you need to create to implement the IP addressing scheme?

ANSWER:
- Houston:
  - Wired: 172.16.30.0/24 and 172.16.31.0/24 (supernetted)
  - Wireless: 172.16.55.0/24

- Mexico City:
  - Wired: 172.16.35.0/24
  - Wireless: 172.16.56.0/24

- Portland:
  - Wired: 172.16.40.0/24
  - Wireless: 172.16.57.0/24

Lease durations:
- Wired: 8 days
- Wireless: 1 day

------------------------------------------------------------
### QUESTION 2
Where will DNS services come from?

ANSWER:
- LON-DC1 will provide DNS for all DHCP scopes.

------------------------------------------------------------
### QUESTION 3
How will DHCP messages reach branch offices?

ANSWER:
- DHCP relay agents will be configured in each branch.

------------------------------------------------------------
### QUESTION 4
What changes are required on NA-RTR?

ANSWER:
- Assign IP addresses to branch-facing interfaces
- Configure those interfaces as DHCP relay agents

------------------------------------------------------------
### QUESTION 5
How will different IP ranges be assigned?

ANSWER:
- Separate DHCP scopes for:
  - Each location
  - Wired vs Wireless clients
- Routers relay requests for wired networks
- Wireless access points relay requests for wireless networks

------------------------------------------------------------
### QUESTION 6
What IPs will be assigned to NA-RTR interfaces?

ANSWER:
- Houston interface: 172.16.30.1
- Mexico City interface: 172.16.35.1
- Portland interface: 172.16.40.1

------------------------------------------------------------
### QUESTION 7
How will DHCP failover be implemented?

ANSWER:
- LON-SVR1 will be configured as a HOT STANDBY DHCP server for TOR-SVR1

### RESULT:
You have successfully PLANNED the DHCP implementation.

# EXERCISE 2: IMPLEMENT THE DHCP CONFIGURATION


------------------------------------------------------------
## TASK 1: INSTALL AND CONFIGURE THE DHCP SERVER (TOR-SVR1)
------------------------------------------------------------

1. Sign in to TOR-SVR1 as Contoso\Administrator / Pa55w.rd
2. Open Windows PowerShell ISE
3. Run: Get-Command *dhcp*
   - No output confirms DHCP is not installed

4. Open Server Manager
5. Go to Manage → Add Roles and Features
6. Click Next through:
   - Installation type
   - Destination server

7. Select DHCP Server role
8. Click Add Features
9. Click Next through remaining pages
10. Click Install
11. Wait for completion → Click Close

12. In Server Manager → Tools
    - Confirm DHCP now appears

13. In PowerShell ISE:
    Run: Get-Command *dhcp*
    - DHCP cmdlets should now appear

------------------------------------------------------------
## POST-INSTALL DHCP CONFIGURATION
------------------------------------------------------------

1. In Server Manager → Notifications
2. Click Complete DHCP configuration
3. Click Next on Description page
4. On Authorization page → Select Commit
5. Click Close

------------------------------------------------------------
## TASK 2: CONFIGURE DHCP SCOPES
------------------------------------------------------------

### CREATE HOUSTON WIRED SCOPE 1
- Name: Houston-wired1
- Range: 172.16.30.2 – 172.16.30.254
- Subnet Mask: 255.255.255.0
- Gateway: 172.16.30.1
- Lease: 8 days
- Activate scope

### CREATE HOUSTON WIRED SCOPE 2
- Name: Houston-wired2
- Range: 172.16.31.2 – 172.16.31.254
- Subnet Mask: 255.255.255.0
- Gateway: 172.16.31.1
- Lease: 8 days
- Activate scope

### CREATE HOUSTON WIRELESS SCOPE
- Name: Houston-wireless
- Range: 172.16.55.2 – 172.16.55.254
- Subnet Mask: 255.255.255.0
- Gateway: 172.16.55.1
- Lease: 1 day
- Activate scope

------------------------------------------------------------
## CREATE HOUSTON SUPERSCOPE
------------------------------------------------------------

1. Right-click IPv4 → New Superscope
2. Name: Houston-wired
3. Select:
   - Houston-wired1
   - Houston-wired2
4. Finish

------------------------------------------------------------
## CREATE MEXICO CITY SCOPES
------------------------------------------------------------

### MexicoCity-wired
- Range: 172.16.35.2 – 172.16.35.254
- Gateway: 172.16.35.1
- Lease: 8 days

### MexicoCity-wireless
- Range: 172.16.56.2 – 172.16.56.254
- Gateway: 172.16.56.1
- Lease: 1 day

------------------------------------------------------------
## CREATE PORTLAND SCOPES
------------------------------------------------------------

### Portland-wired
- Range: 172.16.40.2 – 172.16.40.254
- Gateway: 172.16.40.1
- Lease: 8 days

### Portland-wireless
- Range: 172.16.57.2 – 172.16.57.254
- Gateway: 172.16.57.1
- Lease: 1 day

# Lab: Implement DHCP

## Exercise 3: Implement DHCP failover

### Task 1: Deploy the DHCP server role on LON-SVR1

#### Install the DHCP server role on LON-SVR1
1. Switch to the **LON-SVR1** virtual machine (VM).
2. If necessary, sign in as `Contoso\Administrator` with the password `Pa55w.rd`.
3. Select **Start**, and then select **Server Manager**.
4. In Server Manager, select **Manage**, and then select **Add Roles and Features**.
5. On the **Before you begin** page, select **Next**.
6. On the **Select installation type** page, select **Next**.
7. On the **Select destination server** page, select **Next**.
8. On the **Select server roles** page, select **DHCP Server**.
9. In the **Add Roles and Features Wizard** dialog box, select **Add Features**, and then select **Next**.
10. On the **Select features** page, select **Next**.
11. On the **DHCP Server** page, select **Next**.
12. On the **Confirm installation selections** page, select **Install**.
13. Wait until the installation has succeeded, and then select **Close**.

#### Perform the DHCP server post-installation configuration
14. On **LON-SVR1**, in Server Manager, on the menu bar, select the **Notifications** icon.
15. Select the **Complete DHCP configuration** link.
16. In the **DHCP Post-Install configuration wizard**, on the **Description** page, select **Next**.
17. On the **Authorization** page, select **Commit**.
18. On the **Summary** page, select **Close**.

---

### Task 2: Configure DHCP failover between TOR-SVR1 and LON-SVR1

1. Switch to the **TOR-SVR1** virtual machine.
2. In the **DHCP console**, in the navigation pane, right-click the **IPv4** node, and then select **Configure Failover**.
3. On the **Introduction to DHCP Failover** page, verify that **all TOR-SVR1 scopes are selected** (there should be seven scopes), and then select **Next**.
4. On the **Specify the partner server to use for failover** page, select **Add Server**.
5. In the **Add Server** dialog box, in the **This server** text box, enter `172.16.0.11` (the IP address of **LON-SVR1**), and then select **OK**.
6. Select **Next**.
7. On the **Create a new failover relationship** page:
   - Set **Mode** to `Hot standby`
   - Set **Maximum Client Lead Time (MCLT)** to `1 minute`
8. In the **Shared Secret** text box, enter `Pa55w.rd`.
9. Select **Next**, and then select **Finish**.
10. In the **Configure Failover** dialog box, select **Close**.

11. Switch to the **LON-SVR1** virtual machine.
12. In Server Manager, select **Tools**, and then select **DHCP**.
13. In the DHCP console, expand **lon-svr1.contoso.com**.
14. Expand **IPv4**.
15. Verify that the **superscope and five scopes** are listed.
    - These scopes are synchronized from **TOR-SVR1**.

---

### Task 3: Configure a DHCP relay agent on NA-RTR for Houston, Mexico City, and Portland

1. Switch to the **NA-RTR** virtual machine.
2. On NA-RTR, select **Start**, and then select **Server Manager**.
3. In Server Manager, select **Tools**, and then select **Routing and Remote Access**.
4. In the **Routing and Remote Access** console, expand the **IPv4** node.
5. Right-click **General**, and then select **New Routing Protocol**.
6. In the **New Routing Protocol** dialog box, verify that **DHCP Relay Agent** is selected, and then select **OK**.
7. In the navigation pane, right-click **DHCP Relay Agent**, and then select **Properties**.
8. In the **Server address** box, enter `172.16.18.20` (TOR-SVR1), select **Add**.
9. Enter `172.16.0.11` (LON-SVR1), select **Add**, and then select **OK**.
10. Right-click **DHCP Relay Agent**, and then select **New Interface**.
11. Select the **HOU_WAN** interface, and then select **OK**.
12. In the **DHCP Relay Properties - HOU_WAN** dialog box, select **OK**.
13. Repeat steps 10–12 for:
    - **MEX_WAN**
    - **POR_WAN**

---

## Exercise 4: Validate the DHCP implementation

### Task 1: Test the DHCP allocation to the correct subnets

1. Switch to the **LON-CL1** virtual machine.
2. If necessary, sign in as `Contoso\Administrator` with the password `Pa55w.rd`.
3. Select **Start**, enter `network conn`, and then select **View network connections**.
4. Right-click **London_Network**, and then select **Disable**.
5. Right-click **HOU_WAN**, and then select **Enable**.
6. Right-click **HOU_WAN**, select **Properties**.
7. Select **Internet Protocol Version 4 (TCP/IPv4)**, and then select **Properties**.
8. Ensure **Obtain an IP address automatically** is selected.
9. Select **OK**, and then select **Close**.
10. Open **Windows Terminal**.
11. Run:
    ipconfig /all
12. Verify that:
    - IP address is `172.16.30.2`
    - DHCP server is `172.16.18.20`

13. Disable **HOU_WAN**.
14. Enable **MEX_WAN**.
15. Run:
    ipconfig /all
16. Verify that the IP address is `172.16.35.2`.

17. Disable **MEX_WAN**.
18. Enable **POR_WAN**.
19. Run:
    ipconfig /all
20. Verify that the IP address is `172.16.40.2`.

---

### Task 2: Test DHCP failover

1. Switch to **TOR-SVR1**.
2. Open **Server Manager** → **Tools** → **Services**.
3. Select **DHCP Server**, and then select **Stop Service**.
4. Switch to **LON-CL1**.
5. Run:
    ipconfig /release
6. Run:
    ipconfig /renew
7. Run:
    ipconfig /all
8. Verify that the DHCP server is now `172.16.0.11` (LON-SVR1).

---

## Results
After completing this exercise, you verified correct DHCP address allocation per subnet and confirmed DHCP failover functionality.
