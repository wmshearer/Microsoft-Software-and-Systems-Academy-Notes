- [ ] ## LAB: CONFIGURE DIRECTORY SYNCHRONIZATION (AD DS ↔ MICROSOFT ENTRA ID)

- [ ] IMPORTANT NOTICE (READ FIRST)
- [ ] - You MUST create the Microsoft Entra tenant / Office 365 E5 trial from your PERSONAL host computer (NOT inside the online lab).
- [ ] - You need: mobile phone + valid credit card (verification only). Disable recurring billing so you don’t get charged.
- [ ] - If no credit card, use Microsoft 365 Developer Program trial instead.
- [ ] - You may be prompted to set up Microsoft Authenticator or phone verification.

------------------------------------------------------------

- [ ] ## EXERCISE 1: PREPARE FOR DIRECTORY SYNCHRONIZATION

- [ ] ## TASK 1: CREATE A TRIAL OFFICE 365 E5 SUBSCRIPTION (HOST COMPUTER ONLY)
- [ ] 1. From your HOST computer, open a new **InPrivate** window in Microsoft Edge.
- [ ] 2. In the address bar, go to:
- [ ]    https://products.office.com/en-us/business/office-365-enterprise-e5-business-software
- [ ] 3. Select **Try for Free**.
- [ ] 4. On the “Let’s get you started” page, in **Email**, enter:
- [ ]    `mmddyyyourinitials@outlook.com`
- [ ]    (mmddyy = month/day/year in 2 digits each)
- [ ] 5. Select **Next**.
- [ ] 6. You’ll be directed to create a new account. Select **Set up account**.
- [ ] 7. On “Tell us about yourself”, fill in:
- [ ]    - First name: your choice
- [ ]    - Last name: your choice
- [ ]    - Business phone number: your cell phone number
- [ ]    - Company name: Contoso
- [ ]    - Company size: 10–24 people
- [ ]    - Country/Region: your country of residence
- [ ]    Then select **Next**.
- [ ] 8. On “Security check”:
- [ ]    - Select **Text me**
- [ ]    - Enter your phone number
- [ ]    - Select **Send verification code**
- [ ] 9. Retrieve the code from your phone, enter it, and select **Verify**.
- [ ] 10. On “How you’ll sign in”, enter:
- [ ]     - Username: your choice
- [ ]     - Domain name: `mmddyyyourinitialsContoso.onmicrosoft.com`
- [ ]       Click **Save**
- [ ]     - Password / Confirm password: `Pa55w.rd1234`
- [ ]     Select **Next**.
- [ ] 11. On “Quantity and payment”:
- [ ]     - Verify license quantity is **1**
- [ ]     - NOTE the trial expiration date (lower-right corner)
- [ ]     - Select **Add payment method**
- [ ] 12. On “Add payment method”:
- [ ]     - Enter your personal details + credit card number
- [ ]     - Select **Save**
- [ ]     (No charge now — verification only.)
- [ ] 13. On “Review and confirm”:
- [ ]     - Review details
- [ ]     - NOTE the trial expiration date again
- [ ]     - Select **Start trial**
- [ ] 14. On “Add extra security to your account”, select **Next**.
- [ ] 15. On “Action Required”, select **Next**.
- [ ] 16. On “Keep your account secure”:
- [ ]     - Select **I want to set up a different method**
- [ ]     - Select **Phone**
- [ ] 17. On “Phone”:
- [ ]     - Enter your mobile number → **Next**
- [ ]     - Enter the code → **Next**
- [ ]     - On verification complete → **Next** → **Done**
- [ ] 18. On “Start using your new product”:
- [ ]     - NOTE your username
- [ ]     - Select **Start using Office 365 E5 (no Teams) - Trial**
- [ ] 19. The Microsoft 365 admin center opens.
- [ ] 20. In the left navigation pane:
- [ ]     - Expand **Billing**
- [ ]     - Select **Your products**
- [ ] 21. Select **Office 365 E5 (no Teams)**.
- [ ] 22. On that page, select **Edit recurring billing**.
- [ ] 23. Set recurring billing to **Off** → **Save** → **Yes**.
- [ ] 24. Confirm recurring billing is OFF so it will NOT auto-renew after the trial.

- [ ] ## TASK 2: VERIFY THE MICROSOFT ENTRA TENANT (ONLINE LAB ENVIRONMENT)
- [ ] 1. In the ONLINE lab environment, sign in to **LON-CL1** as:
- [ ]    `Contoso\Administrator` / `Pa55w.rd`
- [ ] 2. Open Microsoft Edge.
- [ ] 3. Browse to:
- [ ]    https://entra.microsoft.com
- [ ] 4. Expand **Users** → select **All users**.
- [ ] 5. Ensure you see your user account.
- [ ] 6. In the navigation pane, select **Show more**.
- [ ] 7. Expand **Settings** → select **Domain names**.
- [ ] 8. Verify your domain:
- [ ]    `mmddyyyourinitialsContoso.onmicrosoft.com`
- [ ] 9. Close Microsoft Edge.
- [ ] 10. Complete all further exercises from within the online lab environment.

- [ ] RESULTS: After completing Exercise 1, you have verified the Microsoft Entra tenant.

------------------------------------------------------------

- [ ] ## EXERCISE 2: CONFIGURE DIRECTORY SYNCHRONIZATION

- [ ] ## TASK 1: CONFIGURE A SYNCHRONIZATION ACCOUNT
- [ ] 1. Switch to **LON-SVR1**.
- [ ] 2. Sign in as:
- [ ]    `Contoso\Administrator` / `Pa55w.rd`
- [ ] 3. From the taskbar, open Microsoft Edge and browse to:
- [ ]    http:\\entra.microsoft.com
- [ ] 4. Sign in as:
- [ ]    `User@mmddyyyourinitialsContoso.onmicrosoft.com`
- [ ]    Password: `Pa55w.rd1234`
- [ ]    (User = the username you created in Exercise 1.)
- [ ] 5. In Microsoft Entra admin center:
- [ ]    - Expand **Users**
- [ ]    - Select **All users**
- [ ] 6. Select **New user** → **Create new user**.
- [ ] 7. In the Identity section enter:
- [ ]    - User principal name: `Sync`
- [ ]    - Display name: `Sync`
- [ ] 8. In the Password section enter:
- [ ]    - Auto-generate password: NOT selected
- [ ]    - Password: `Pa55w.rd1234`
- [ ] 9. Select **Next: Properties**.
- [ ] 10. Enter:
- [ ]     - First name: `Sync`
- [ ]     - Last name: `User`
- [ ]     - Ensure User type: `Member`
- [ ] 11. Select **Next: Assignments**.
- [ ] 12. Select **Add role**.
- [ ] 13. In Directory roles, select **Global Administrator** → **Select**.
- [ ] 14. Select **Review + create** → **Create**.
- [ ] 15. Right-click Microsoft Edge on the taskbar → select **New InPrivate window**.
- [ ] 16. In the InPrivate window, browse to:
- [ ]     https://portal.azure.com
- [ ] 17. Sign in as:
- [ ]     `sync@mmddyyyourinitialsContoso.onmicrosoft.com`
- [ ]     Password: `Pa55w.rd1234`
- [ ] 18. On “Update your password”:
- [ ]     - Current password: `Pa55w.rd1234`
- [ ]     - New password: `Pa55w.rd1234!`
- [ ]     - Confirm password: `Pa55w.rd1234!`
- [ ]     Select **Sign in**.
- [ ] 19. If “Action Required” displays, select **Ask later**.
- [ ] 20. Select **No** at “Stay signed in”.
- [ ] 21. Verify Azure portal opens.
- [ ] 22. Close the InPrivate window.
- [ ] 23. Keep the Microsoft Entra admin center window open.

------------------------------------------------------------

- [ ] ## TASK 2: CONFIGURE MICROSOFT ENTRA CLOUD SYNC
- [ ] NOTE: Scope Cloud Sync to ONLY the `IT` OU in `Contoso.com`.

- [ ] 1. In Microsoft Entra admin center navigation:
- [ ]    - Expand **Identity**
- [ ]    - Expand **Hybrid management**
- [ ]    (You may need to select **Show more**.)
- [ ] 2. Select **Microsoft Entra Connect**.
- [ ] 3. On the Microsoft Entra Connect page, select **Cloud Sync**.
- [ ] 4. On **Cloud sync | Configurations**, select **Agents**.
- [ ] 5. On **Cloud sync | Agents**, select **Download on-premises agent**.
- [ ] 6. On Microsoft Entra Provisioning page, select **Accept terms & download**.
- [ ] 7. In the Downloads notification, select **Open file**.
- [ ] 8. In Microsoft Entra Provisioning Agent Package Setup:
- [ ]    - Select **I agree to the license terms and conditions**
- [ ]    - Select **Install**
- [ ] 9. In the Microsoft Entra Provisioning Agent Configuration Wizard:
- [ ]    - Welcome → **Next**
- [ ] 10. On Select Extension:
- [ ]     - Select **HR-driven provisioning**
- [ ]     - Select **Next**
- [ ] 11. On Sign in to your account:
- [ ]     - Enter `Sync@mmddyyyourinitialsContoso.onmicrosoft.com`
- [ ]     - Select **Next**
- [ ] 12. On Enter password:
- [ ]     - Enter `Pa55w.rd1234!`
- [ ]     - Select **Sign in**
- [ ] 13. On Configure Service Account:
- [ ]     - Select **Create gMSA**
- [ ]     - Provide domain credentials:
- [ ]       `Contoso\Administrator` / `Pa55w.rd`
- [ ]     - Select **Next**
- [ ] 14. On Connect Active Directory:
- [ ]     - Ensure `Contoso.com` is listed as the Domain
- [ ]     - Select **Next**
- [ ] 15. On Confirm:
- [ ]     - Review settings
- [ ]     - Select **Confirm**
- [ ] 16. Wait for the agent install to complete (may take several minutes).
- [ ] 17. On Confirm page:
- [ ]     - Select **Exit**
- [ ]     - Close Microsoft Entra Provisioning Agent Package Setup

- [ ] 18. Back on **Cloud sync | Agents** page, select **Configurations**.
- [ ] 19. Select **New configuration** → **AD to Microsoft Entra ID sync**.
- [ ] 20. On New cloud sync configuration page:
- [ ]     - Under active agents, verify `Contoso.com` is listed
- [ ]     - Select **Create**
- [ ] 21. Wait for configuration creation (may take a couple minutes).
- [ ] 22. On **Contoso.com | Overview**, select **Scoping filters**.
- [ ] 23. Select **Selected organizational units**.
- [ ] 24. When prompted about scoping type change, select **OK**.
- [ ] 25. In OU entry box, enter:
- [ ]     `OU=IT,DC=Contoso,DC=com`
- [ ]     Select **Add** → select **Save**
- [ ] 26. Select **Overview**.
- [ ] 27. Select **Review and enable**.
- [ ] 28. On Review and enable configuration page, select **Enable configuration**.

------------------------------------------------------------

- [ ] ## TASK 3: MONITOR AND VERIFY THE INITIAL SYNCHRONIZATION
- [ ] 1. On **Cloud sync | Configurations**:
- [ ]    - Verify Status for `Contoso.com` is **Healthy**
- [ ]    - Select **Audit logs**
- [ ] 2. Review activity:
- [ ]    - Select **Refresh** every couple minutes
- [ ]    - It may take 10–15 minutes
- [ ] 3. On **Cloud sync | Audit logs**, select **Provisioning logs**.
- [ ] 4. Review and validate actions:
- [ ]    - Select **Refresh** every couple minutes
- [ ]    - It may take 10–15 minutes
- [ ] 5. In Microsoft Entra admin center navigation:
- [ ]    - Expand **Identity**
- [ ]    - Expand **Users**
- [ ]    - Select **All users**
- [ ] 6. Verify users synchronized from Contoso.com:
- [ ]    - On-premises sync enabled = **Yes**
- [ ]    - These should be ONLY users from the `IT` OU

------------------------------------------------------------

- [ ] ## TASK 4: INSTALL AND CONFIGURE MICROSOFT ENTRA CONNECT
- [ ] NOTE: Scope Entra Connect Sync to include ALL OUs EXCEPT the `IT` OU (already synced by Cloud Sync).

- [ ] 1. Open a NEW tab in Microsoft Edge.
- [ ] 2. Browse to:
- [ ]    https://www.microsoft.com/en-ie/download/details.aspx?id=47594&msockid=2584d9c663aa6b333bb4c84d62006aba
- [ ] 3. Select **Download**.
- [ ] 4. On the Downloads prompt under `AzureADConnect.msi`, select **Open file**.
- [ ] 5. Microsoft Entra Connect Sync installs and then starts the wizard.
- [ ] 6. On Welcome page:
- [ ]    - Select **I agree to the license terms and privacy notice**
- [ ]    - Select **Continue**
- [ ] 7. On Express Settings page:
- [ ]    - Select **Use express settings**
- [ ] 8. On Connect to Microsoft Entra ID page:
- [ ]    - USERNAME: `sync@mmddyyyourinitialsContoso.onmicrosoft.com`
- [ ]    - Password: `Pa55w.rd1234!`
- [ ]    - Select **Sign in**
- [ ] 9. If “Action Required” displays, select **Ask later**.
- [ ] 10. On Connect to AD DS page:
- [ ]     - USERNAME: `Contoso\Administrator`
- [ ]     - PASSWORD: `Pa55w.rd`
- [ ]     - Select **Next**
- [ ] 11. On Microsoft Entra sign-in configuration page:
- [ ]     - Select **Continue without matching all UPN suffixes to verified domains**
- [ ]     - Select **Next**
- [ ] 12. On Ready to configure page:
- [ ]     - REMOVE check mark next to:
- [ ]       “Start the syncronization process when configuration completes”
- [ ]     - Select **Install**
- [ ]     - When complete, select **Exit**

- [ ] 13. Minimize Microsoft Edge.

- [ ] 14. On LON-SVR1 desktop, open **Azure AD Connect**
- [ ]     (Branding may show Microsoft Entra Connect in later versions.)
- [ ] 15. On Welcome page, select **Configure**.
- [ ] 16. On Additional tasks page:
- [ ]     - Select **Customize synchronization options**
- [ ]     - Select **Next**
- [ ] 17. On Connect to Microsoft Entra ID page:
- [ ]     - USERNAME: `sync@mmddyyyourinitialsContoso.onmicrosoft.com`
- [ ]     - Select **Next**
- [ ] 18. Select the sync account.
- [ ] 19. Enter password: `Pa55w.rd1234!`
- [ ] 20. Select **Sign in**.
- [ ] 21. On Connect your directories page, select **Next**.
- [ ] 22. On Domain and OU filtering page:
- [ ]     - Select **Sync selected domains and OUs**
- [ ] 23. Expand `Contoso.com`.
- [ ] 24. Remove the check mark next to `Contoso.com`.
- [ ]     (This clears all OUs under the domain.)
- [ ] 25. Select ONLY these OUs:
- [ ]     - Development
- [ ]     - Infrastructure
- [ ]     - Managers
- [ ]     - Marketing
- [ ]     - Research
- [ ]     - Sales
- [ ] 26. Select **Next**.
- [ ] 27. On Optional features page, select **Next**.
- [ ] 28. On Ready to configure page:
- [ ]     - CHECK “Start the syncronization process when configuration completes”
- [ ] 29. Select **Configure**.
- [ ] 30. When configuration completes, select **Exit**.
- [ ] 31. Wait ~5–10 minutes for sync to complete.

------------------------------------------------------------

- [ ] ## TASK 5: VERIFY SYNCHRONIZATION AND MANAGE SETTINGS
- [ ] 1. Restore Microsoft Edge (Microsoft Entra admin center).
- [ ] 2. Expand **Users** → select **All users**.
- [ ] 3. Verify AD DS user accounts are listed.
- [ ] 4. Confirm synchronized users show:
- [ ]    - On-premises sync enabled = **Yes**

- [ ] 5. On LON-SVR1:
- [ ]    - Select Start
- [ ]    - Expand **Microsoft Entra Connect** (or **Azure AD Connect**)
- [ ]    - Select **Synchronization Service**
- [ ] 6. In Synchronization Service Manager:
- [ ]    - Select **Operations** tab
- [ ] 7. Verify you see:
- [ ]    - Export
- [ ]    - Full Synchronization
- [ ]    - Full Import
- [ ] 8. Verify each task has current Start/End times AND Status indicates success.
- [ ]    (Completed-no-objects is normal for some tasks.)
- [ ] 9. Close Synchronization Service Manager.

- [ ] 10. On LON-SVR1, open **Windows PowerShell ISE**.
- [ ] 11. Run:
- [ ]     Get-ADSyncScheduler
- [ ] 12. Verify:
- [ ]     - AllowedSyncCycleInterval = 30 minutes
- [ ]     - CurrentlyEffectiveSyncCycleInterval = 30 minutes
- [ ] 13. Run:
- [ ]     Set-ADSyncScheduler -CustomizedSyncCycleInterval 01:00:00
- [ ] 14. Run:
- [ ]     Start-ADSyncSyncCycle -Policytype Delta
- [ ] 15. Wait approximately 2 minutes.
- [ ] 16. Run:
- [ ]     Get-ADSyncScheduler
- [ ] 17. Verify the new value is applied for:
- [ ]     CurrentlyEffectiveSyncCycleInterval
- [ ] 18. Close Windows PowerShell ISE.

- [ ] RESULTS: After completing Exercise 2, you have installed Entra Connect with custom settings, completed directory sync, and verified sync success.

