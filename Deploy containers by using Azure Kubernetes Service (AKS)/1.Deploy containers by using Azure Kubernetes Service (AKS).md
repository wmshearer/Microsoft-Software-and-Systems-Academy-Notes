# Azure Kubernetes Service (AKS)

## Kubernetes Overview
- Container orchestration platform
- Focuses on application workloads, not infrastructure
- Declarative deployment model
- Managed via APIs
- Supports stateless and stateful applications
- Designed for microservices
- Integrates with CI/CD pipelines
- Platform-agnostic (language, OS, libraries)

## Azure Kubernetes Service (AKS)
- Managed Kubernetes service in Azure
- Azure manages the control plane
- Customers manage and pay for worker nodes
- Reduces operational overhead (upgrades, availability)

## Core AKS Components
- AKS Control Plane (managed by Azure)
- Worker Nodes (Azure VMs)
- Virtual Network (auto-created or customer-managed)
- Ingress controller (HTTP/S routing)
- Azure Load Balancer (L4 traffic distribution)
- External data stores (Azure SQL, Cosmos DB)
- Azure Active Directory (identity and access)
- Azure Container Registry (container images)
- Azure Monitor (logs, metrics, telemetry)

## Kubernetes Cluster Architecture
- Cluster = control plane + one or more nodes
- Control plane:
  - kube-apiserver
  - kube-controller-manager
  - kube-scheduler
  - etcd (cluster state store)
- Nodes:
  - Run application workloads
  - Communicate with control plane via API server
  - Run kubelet and container runtime
- Default OS: Linux

## Control Plane Responsibilities
- Maintains desired state
- Schedules pods to nodes
- Manages scaling, updates, rollbacks
- Stores cluster state in etcd

## kubectl
- Primary CLI for interacting with Kubernetes
- Sends commands to kube-apiserver
- Used by developers and operators

## Deployments and Self-Healing
- Desired state defined using YAML
- Deployments use ReplicaSets
- ReplicaSets ensure specified pod count
- Failed pods are automatically replaced
- Supports:
  - Rolling updates
  - Rollbacks
  - Paused deployments

## Pods
- Smallest deployable unit in Kubernetes
- Represents a single application instance
- Typically 1 pod = 1 container
- Can run multiple containers (shared resources)
- Pods are ephemeral
- Managed by controllers (e.g., Deployments)

## Pod Resource Management
- Resource requests:
  - Minimum CPU and memory required
- Resource limits:
  - Maximum CPU and memory allowed
- Helps scheduler place pods correctly
- Prevents resource exhaustion

## Nodes and Node Pools
- Nodes = worker VMs running workloads
- Every AKS cluster requires:
  - At least one system node pool
- Node pools group nodes with same configuration
- System node pool:
  - Runs core Kubernetes components
- User node pools:
  - Run application workloads
- Multiple node pools allow workload isolation

## Namespaces
- Logical separation of cluster resources
- Used for access control and organization
- Default namespaces:
  - default: application workloads
  - kube-system: core Kubernetes services
  - kube-public: cluster-wide visible resources

## Networking Overview
- Nodes connect to a virtual network
- kube-proxy provides pod networking
- Services abstract pod networking
- Traffic distribution via load balancers
- Advanced routing via ingress controllers

## Kubernetes Services
- Provide stable access to pods
- Types:
  - ClusterIP: internal-only access
  - NodePort: exposes service on node IP and port
  - LoadBalancer: creates Azure Load Balancer
  - ExternalName: DNS alias to external service

## Load Balancers
- Can be internal or external
- External:
  - Public IP
  - Internet-accessible
- Internal:
  - Private IP
  - VNet-only access
- Can use static or dynamic IPs

## AKS Networking Models

### Kubenet (Basic)
- Default AKS networking option
- Nodes get IPs from VNet subnet
- Pods get IPs from separate address space
- NAT used for pod-to-VNet traffic
- Pods not directly routable
- Conserves IP addresses

### Azure CNI (Advanced)
- Pods get IPs directly from VNet subnet
- Pods are directly routable
- Requires advanced IP planning
- Higher risk of IP exhaustion
- No NAT for intra-VNet traffic

## Ingress Controllers
- Operate at Layer 7 (HTTP/S)
- Route traffic based on URL/host rules
- Provide advanced traffic management
- More flexible than LoadBalancer services

## Key Exam Concepts
- Kubernetes uses a declarative model
- kubectl interacts with the control plane
- Pods are ephemeral and self-healed
- Resource requests and limits control scheduling
- AKS control plane is managed and free
