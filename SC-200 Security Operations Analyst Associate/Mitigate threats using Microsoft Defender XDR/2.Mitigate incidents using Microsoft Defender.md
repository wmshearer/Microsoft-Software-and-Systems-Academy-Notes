# Use the Microsoft Defender Portal

## Microsoft Defender Portal Overview

- Portal URL: `https://security.microsoft.com`
- Central workspace for security teams across Microsoft 365
- Integrates protection, detection, investigation, and response
- Role-based access control (RBAC) determines visible data and cards
- Aggregates signals for a single, holistic view of the environment
- Replaces and unifies older security portals into a single console

## Integrated Products in the Portal

- Microsoft Defender for Office 365
  - Email and collaboration protection
  - Phishing, malware, investigation, and hunting
- Microsoft Defender for Endpoint
  - Endpoint prevention, detection, automated investigation, and response
- Microsoft Defender XDR (Extended Detection and Response)
  - Correlates signals across domains into unified incidents
- Microsoft Defender for Cloud Apps
  - Software-as-a-Service (SaaS) and Platform-as-a-Service (PaaS) visibility and control
- Microsoft Defender for Identity
  - Uses on-premises Active Directory signals to detect identity attacks
- Microsoft Defender Vulnerability Management
  - Asset inventory, risk-based vulnerability assessment, remediation
- Microsoft Defender for Internet of Things (IoT)
  - Secures operational technology environments
- Microsoft Sentinel
  - Security Information and Event Management (SIEM) and Security Orchestration, Automation, and Response (SOAR) integration

## Related Portals Accessible from Defender

- Microsoft Purview
  - Compliance, data governance, eDiscovery
- Microsoft Entra ID
  - Identity, authentication, conditional access
- Microsoft Entra ID Protection
  - Identity risk detection and remediation
- Azure Information Protection
  - Data classification and labeling
- Microsoft Defender for Cloud
  - Cloud workload protection

# Microsoft Defender XDR Unified RBAC (Role-Based Access Control)

## Unified RBAC Model

- Consolidates permissions from individual Defender products
- Replaces individual RBAC models once activated
- Principle of least privilege is recommended
- Global Administrator should be limited to emergencies

## Key Timeline Changes

- Feb 16, 2025
  - Unified RBAC becomes default for new Defender for Endpoint tenants
- Mar 2, 2025
  - Unified RBAC becomes default for new Defender for Identity tenants

## Key RBAC Concepts

- Permissions align to:
  - Security operations
  - Security posture management
  - Authorization and settings
- Intune endpoint security permissions are managed separately in Intune

## Microsoft Entra Global Roles

- Microsoft Entra global roles automatically grant Defender portal access
- Roles such as:
  - Global Administrator
  - Security Administrator
  - Security Reader
- Permissions vary by workload (Endpoint, Identity, Office, Cloud Apps)

# Manage Incidents

## Incident Concept

- An incident is a group of correlated alerts
- Represents the full attack story across devices, users, and mailboxes
- Automatically created by Microsoft Defender XDR correlation analytics

## Incident Queue

- Displays incidents from the last 30 days
- Sorted with most recent incidents first
- Used to prioritize response based on risk and severity

## Incident Management Capabilities

- Rename incidents
- Assign incidents to analysts
- Set status (Active or Resolved)
- Classify incidents (True alert or False alert)
- Add tags and comments
- Move alerts between incidents

## Incident Prioritization Filters

- Status
- Severity
- Assignment
- Multiple service sources
- Categories
- Entities
- Device group
- Operating system
- Data sensitivity (requires Microsoft Purview)
- Automated investigation state
- Associated threat

## Incident Preview Options

- Circle icon
  - Opens right-side preview pane
- Greater-than symbol
  - Expands related records
- Link
  - Opens full incident page

# Investigate Incidents

## Incident Overview Page

- Attack categories aligned to MITRE ATT&CK framework
- Scope of impacted assets
- Alerts timeline
- Evidence summary with remediation status
- Used for initial triage

## Incident Tabs

- Alerts
  - All related alerts and sources
- Devices
  - Affected endpoints
- Users
  - Involved identities
- Mailboxes
  - Affected email accounts
- Apps
  - Involved applications
- Investigations
  - Automated investigations and pending actions
- Evidence and Responses
  - Files, processes, verdicts, remediation
- Incident Graph
  - Visual correlation of attack entities

## Blast Radius Analysis (Preview)

- Extends incident graph with pre-breach and post-breach analysis
- Requires Microsoft Sentinel data lake onboarding
- Shows potential lateral movement paths to critical assets
- Respects RBAC scoping
- Used by:
  - Analysts for scoping
  - Engineers for remediation planning
  - Incident responders for containment
  - Leadership for impact communication

# Manage and Investigate Alerts

## Alert Severity Levels

- High
  - Advanced persistent threat (APT), ransomware, credential theft
- Medium
  - Suspicious post-breach behaviors
- Low
  - Commodity malware or tools
- Informational
  - Awareness-level alerts

## Defender Antivirus vs Defender for Endpoint Severity

- Antivirus severity
  - Absolute malware threat to device
- Defender for Endpoint severity
  - Organizational risk and behavioral context

## Alert Categories (MITRE-aligned)

- Initial access
- Execution
- Persistence
- Privilege escalation
- Defense evasion
- Credential access
- Discovery
- Lateral movement
- Command and control
- Collection
- Exfiltration
- Impact (ransomware)
- Malware
- Suspicious activity
- Unwanted software

## Alert Actions

- Assign alerts
- Change status (New, In Progress, Resolved)
- Classify (True alert, False alert)
- Add comments
- Link to incidents
- Suppress alerts
  - Device-specific
  - Organization-wide

## Alert Investigation Flow

- Select alert
- Review alert story
- Pivot through entities
- Take actions from details pane
- Resolve and classify alert
- Create suppression rule if false positive

# Automated Investigation and Remediation (AIR)

## AIR Overview

- Part of Microsoft Defender for Endpoint
- Uses analyst-like logic and automation
- Reduces alert volume
- Tracks actions in Action Center

## Investigation Scope Expansion

- Adds alerts from same device
- Expands to other devices with same threat
- Approval required if expansion includes 10+ devices

## Investigation Results

- Verdicts:
  - Malicious
  - Suspicious
  - No threats found
- Remediation actions:
  - Quarantine file
  - Stop service
  - Remove scheduled task
  - Other cleanup actions

## Automation Levels

- Full automation
  - All remediation actions automatic (recommended)
- Semi-automation
  - Approval required (various folder-based scopes)
- No automation
  - Investigation does not run (not recommended)

# Action Center

## Action Center Purpose

- Central view of all remediation actions
- Covers endpoint, email, and identity actions
- Tabs:
  - Pending
  - History

## Supported Undo Actions

- Isolate device
- Restrict code execution
- Quarantine file
- Remove registry key
- Stop service
- Disable driver
- Remove scheduled task

## Action Sources

- Manual device action
- Manual email action
- Automated device action
- Automated email action
- Advanced hunting action
- Live response action

# Advanced Hunting

## Advanced Hunting Overview

- Query-based threat hunting
- Up to 30 days of raw data
- Uses Kusto Query Language (KQL)
- Supports custom detections

## Data Types

- Event data
  - Near real-time
- Entity data
  - Updated every 15 minutes
  - Consolidated every 24 hours
- Time zone: UTC

## Core Tables (Examples)

- DeviceProcessEvents
- DeviceNetworkEvents
- DeviceLogonEvents
- EmailEvents
- AlertInfo
- AlertEvidence
- IdentityLogonEvents

## Custom Detection Rules

- Built from advanced hunting queries
- Max 100 alerts per run
- Must return:
  - Timestamp
  - DeviceId
  - ReportId

### Example Query

`DeviceEvents
| where Timestamp > ago(7d)
| where ActionType == "AntivirusDetection"
| summarize (Timestamp, ReportId)=arg_max(Timestamp, ReportId), count() by DeviceId
| where count_ > 5`

## Detection Rule Capabilities

- Schedule frequency (hourly to continuous)
- Map impacted entities
- Automatic actions:
  - Isolate device
  - Run antivirus scan
  - Quarantine file
  - Start investigation
- Scope by device groups

# Microsoft Secure Score

## Secure Score Overview

- Measures organizational security posture
- Combines Microsoft 365 Secure Score and Cloud Secure Score
- Part of Exposure Management

## Key Capabilities

- Recommended actions
- Status tracking
- Trend analysis
- Peer comparison
- Third-party mitigation acknowledgment

# Threat Analytics

## Threat Analytics Purpose

- Microsoft threat intelligence from expert researchers
- Focuses on:
  - Active campaigns
  - New techniques
  - Critical vulnerabilities
  - Common attack surfaces

## Threat Tags

- Ransomware
- Phishing
- Vulnerability
- Activity group

## Report Sections

- Overview
- Analyst report
- Related incidents
- Impacted assets
- Prevented email attempts
- Exposure and mitigations

# Reports

## Report Categories

- Security overview
- Endpoint threat protection
- Device health and compliance
- Vulnerable devices
- Web protection
- Firewall
- Attack surface reduction
- Email and collaboration

# Configure Notifications

## Notification Types

- Incidents
- Threat analytics

## Configuration Path

- Settings > Microsoft Defender XDR > Email notifications
- Configure criteria and recipients

# Module Assessment Answers

## Question 1
- When you're reviewing a specific incident, which tab is contained on the incident page?
- Answer: Assets

## Question 2
- You can classify an Incident as which of the following?
- Answer: True positive

## Question 3
- The Devices page shows information from which Defender product?
- Answer: Microsoft Defender for Endpoint
