# Introduction to Microsoft Defender for Office 365

## Microsoft Defender for Office 365 Overview

- Cloud-based email and collaboration security service
- Protects against:
  - Phishing
  - Zero-day malware
  - Malicious URLs
- Provides real-time protection and rich reporting
- Integrated into Microsoft Defender XDR (Extended Detection and Response)

## Key Benefits

- Industry-leading protection
  - Uses trillions of daily signals from email telemetry
  - Detects phishing, zero-day malware, and advanced attacks
- Actionable insights
  - Correlates signals to prioritize risks
  - Provides remediation recommendations
- Automated investigation and response (AIR)
  - Reduces manual investigation effort
  - Saves time and operational cost
- Training and awareness
  - In-product user warnings
  - Attack Simulator for realistic phishing and credential attacks
  - User-reported suspicious content

## Deployment Scenarios

- Filtering-only
  - Protects on-premises Exchange or other SMTP systems
- Exchange Online protection
  - Secures cloud-hosted mailboxes
- Hybrid
  - Protects mixed on-premises and cloud environments
  - Uses Exchange Online Protection (EOP) for inbound filtering

# Automated Investigation and Response (AIR) in Defender for Office 365

## AIR Purpose

- Automatically investigates alerts triggered by email threats
- Uses predefined security playbooks
- Can be triggered automatically or manually

## Example AIR Flow

- Email contains benign URL at delivery time
- URL later becomes weaponized
- Safe Links detonates URL and detects threat
- Alert triggers AIR playbook
- Automated investigation resolves alert

## Investigation Graph

- Summary Investigation Graph shows:
  - Emails
  - URLs
  - Users
  - Devices
- Displays relationships between entities
- Highlights compromised users and anomalous behavior

## Automated Remediation Actions

- Block malicious URLs (time-of-click)
- Soft-delete malicious emails
- Remove related emails from mailboxes
- Trigger Microsoft Entra ID workflows:
  - Password reset
  - Multi-factor authentication (MFA)
- Actions can be:
  - Fully automatic
  - Require analyst approval

## AIR Remediation Actions That May Require Approval

- Soft delete email messages
- Block URLs
- Disable external mail forwarding
- Disable mailbox delegation

# Configure, Protect, and Detect

## Safe Attachments

- Protects against unknown malware and zero-day threats
- Routes attachments to a detonation environment
- Uses machine learning and behavioral analysis

### Safe Attachments Policy Options

- Off
  - No scanning
- Monitor
  - Deliver message, track results
- Block
  - Block message and attachments
- Replace
  - Remove attachment, deliver message body
- Dynamic delivery
  - Deliver message body immediately
  - Attachments delivered after scan completes

### Redirect Options

- Forward detected attachments to security administrators
- Apply redirect if scanning times out or errors

### Targeting

- Policies can target:
  - Users
  - Groups
  - Domains
- Exceptions supported

### Bypassing Safe Attachments (Not Recommended Broadly)

- Use Exchange mail flow rule
- Set header:
  - `X-MS-Exchange-Organization-SkipSafeAttachmentProcessing`
- Only recommended for trusted internal systems (e.g., scanners)

## Safe Links

- Protects users from malicious URLs
- URLs checked at time of click
- Protection persists even after delivery

### Supported Locations

- Microsoft 365 desktop apps
- Office for the web
- Mobile Office apps
- Microsoft Teams chats and channels

### Safe Links Policy Options

- Rewrite and scan unknown URLs
- Scan downloadable content
- Apply protection to internal emails
- Track user clicks (recommended)
- Block users from proceeding to malicious URLs
- Allow trusted URLs (do not rewrite list)

### Bypass Safe Links

- Exchange mail flow rule header:
  - `X-MS-Exchange-Organization-SkipSafeLinksProcessing`

## Anti-Phishing Policies

- No default anti-phishing policy
- Must be explicitly created
- Focus on impersonation detection

### Impersonation Examples

- Domain impersonation:
  - `contoso.com` → `ćóntoso.com`
- User impersonation:
  - `michelle@contoso.com` → `michele@contoso.com`

### Anti-Phishing Configuration Options

- Protect specific users and domains
- Define actions (junk, redirect, etc.)
- Enable safety tips
- Configure trusted senders/domains
- Includes anti-spoofing controls

# Simulate Attacks

## Threat Explorer (Explorer)

- Real-time threat investigation tool
- Shows:
  - Threat families
  - Top targeted users
  - Delivery actions
- Supports filtering by:
  - Sender
  - Recipient
  - Detection technology (EOP vs sandbox)

## Attack Simulator

- Runs realistic attack scenarios
- Identifies user and organizational weaknesses
- Common simulations:
  - Spear phishing
  - Credential harvesting
  - Attachment malware
  - Password spray
  - Brute-force attacks

## Threat Trackers

- Track emerging and trending threats
- Includes:
  - Noteworthy trackers
  - Trending trackers
  - Saved queries

# Summary

- Microsoft Defender for Office 365 is a core email security pillar in Microsoft Defender XDR
- Focus areas:
  - Prevention (Safe Attachments, Safe Links, anti-phishing)
  - Detection (machine learning, sandboxing)
  - Response (AIR)
  - User awareness (simulations, reporting)

# Module Assessment Answers

## Question 1
- Microsoft Defender for Office 365 requires an agent on Windows 10 devices
- Answer: False

## Question 2
- What describes Safe Attachments?
- Answer: Messages and attachments are routed to a special environment where Microsoft Defender for Office 365 uses various machine learning and analysis techniques to detect malicious intent.

## Question 3
- Which is not an Attack Simulator scenario?
- Answer: Bitcoin mining
