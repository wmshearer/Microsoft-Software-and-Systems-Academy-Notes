# Azure AI Custom Vision – Image Classification

## Overview
- Image classification = assigning a label to an image based on its contents
- Common use cases:
  - Retail product identification
  - Inventory automation
  - Wildlife or object categorization
  - Quality control in manufacturing

## Azure AI Custom Vision Service
- Used to build **custom computer vision models**
- Supports:
  - Image classification
  - Object detection
- Requires **two separate resources**:
  - Training resource
  - Prediction resource

## Required Azure Resources
### Training Resource
- Used to:
  - Upload images
  - Tag images
  - Train models
  - Evaluate model performance
- Typically deployed once
- Often used in development or CI/CD pipelines

### Prediction Resource
- Used to:
  - Host published models
  - Run inference on new images
- Can deploy multiple prediction resources
- Enables regional scaling for applications

## Resource Separation Benefits
- Train models in one region
- Deploy prediction endpoints in multiple regions
- Scale prediction independently from training
- Reduce latency for client applications

## Custom Vision Portal
- Web UI: https://www.customvision.ai/
- Used to:
  - Create projects
  - Upload and tag images
  - Train models
  - Test predictions
  - Publish models
- Each project has a **unique Project ID**

## Image Classification Concepts
### Classification Types
- Multiclass classification:
  - One label per image
  - Example: Apple OR Banana OR Orange
- Multilabel classification:
  - Multiple labels per image
  - Example: Person + Bicycle + Helmet

### When to Use Classification vs Detection
- Classification:
  - Identify what the image is mainly about
- Object detection:
  - Locate and label multiple objects in one image

## Training an Image Classification Model
### Typical Workflow (Portal)
1. Create classification project
2. Associate training resource
3. Upload images
4. Assign tags (labels)
5. Train model
6. Evaluate performance
7. Test with sample images
8. Publish model to prediction resource

### Training Considerations
- Balanced number of images per tag
- Varied lighting, angles, backgrounds
- High-quality labeled data improves accuracy

## Publishing a Model
- Publishing makes the model available for inference
- Requires:
  - Prediction resource
  - Published model name
- Multiple versions can be published

## Custom Vision SDKs
### .NET
- Training:
  - Microsoft.Azure.CognitiveServices.Vision.CustomVision.Training
- Prediction:
  - Microsoft.Azure.CognitiveServices.Vision.CustomVision.Prediction

### Python
- Single package for both:
  - azure-cognitiveservices-vision-customvision

## Image Classification Client App (Prediction)
### Required Information
- Prediction endpoint
- Prediction key
- Project ID
- Published model name

### Prediction Flow
- Authenticate using prediction key
- Send image bytes to prediction endpoint
- Receive:
  - List of tags
  - Probability score per tag

### Interpreting Results
- Each prediction includes:
  - tag_name
  - probability (0–1)
- App logic typically applies a confidence threshold
  - Example: probability > 0.5

## Key Differences: Training vs Prediction
- Training resource:
  - Not used by client apps
  - Used only during model creation
- Prediction resource:
  - Used by production apps
  - Handles real-time inference

## Module Assessment – Answers
1. Required resources for Custom Vision?
   - A Custom Vision resource for training, and another for prediction

2. Model to classify images as cat OR dog?
   - Image classification (multiclass)

3. Info needed by a client app to classify images?
   - Prediction endpoint and key, project ID, and deployed model name
