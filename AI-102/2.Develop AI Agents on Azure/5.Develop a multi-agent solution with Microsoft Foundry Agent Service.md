# Connected agents in Microsoft Foundry Agent Service

## Why connected agents
As AI solutions grow more complex, using a single agent to handle everything becomes hard to manage. Microsoft Foundry Agent Service supports **connected agents**, which let you decompose large tasks into smaller, specialized roles without custom orchestration logic or hardcoded routing.

Example scenario used in the module:
- A ticket triage system where different agents classify ticket type, assign priority, and suggest the right team.
- A main agent delegates work to sub-agents, which collaborate to complete the task.

This approach improves efficiency, maintainability, and scalability.

## What are connected agents
Connected agents are agents with **focused responsibilities** that collaborate under a **main agent**.

- Main agent:
  - Interprets user intent
  - Delegates tasks to connected agents
  - Aggregates results
  - Returns a single final response to the user

- Connected (sub-)agents:
  - Perform one well-defined task
  - Use tools if required
  - Return results to the main agent
  - Are not directly visible to the end user

This design:
- Simplifies complex workflows
- Improves accuracy through specialization
- Makes systems easier to debug and extend

## Why use connected agents instead of one big agent
Benefits highlighted:
- No custom orchestration required – routing is done via natural language
- Improved reliability and traceability – agents can be tested independently
- Modular and extensible – add or swap agents without redesigning the system
- Better alignment with real-world business logic

## Designing a multi-agent solution

### Main agent responsibilities
- Interpret user input
- Decide which connected agent(s) to use
- Forward relevant context
- Aggregate or summarize responses
- Produce the final user-facing output

### Connected agent responsibilities
- Focus on a single domain or action
- Execute a specific task
- Use tools if needed
- Return results to the main agent

Rule of thumb:
> One agent = one responsibility

## High-level setup flow (conceptual)
1. Initialize the agents client connected to your Microsoft Foundry project
2. Create connected agents with clear instructions
3. Wrap each connected agent in a `ConnectedAgentTool`
4. Create the main agent and include connected agents as tools
5. Create a thread to manage conversation context
6. Add a user message to the thread
7. Run the agent workflow
8. Retrieve the final response from the main agent

Relevant SDK concepts mentioned:
- `create_agent(...)`
- `ConnectedAgentTool`
- Threads and runs for execution
- Natural-language-based delegation (not code-based routing)

## Key architectural insight
Only the **main agent’s response** is returned to the user.
Connected agents work behind the scenes and are invoked as tools.

This makes connected-agent systems:
- Cleaner for users
- Easier to evolve over time
- Safer for sensitive or specialized operations

# Module assessment answers

## Q1: What is the role of the main agent in a connected agent system?
Correct answer:
- To coordinate user input and route tasks to the appropriate connected agents

## Q2: How do you connect an agent to a main agent using the Azure AI Projects client library?
Correct answer:
- Add the agent as a ConnectedAgentTool to the main agent's tool definition.

## Q3: How does the main agent decide which connected agent to use?
Correct answer:
- It uses prompt instructions and natural language understanding.
