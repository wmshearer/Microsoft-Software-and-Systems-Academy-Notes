# Custom tools in Microsoft Foundry Agent Service

## Why custom tools (module framing)
Foundry Agent Service includes built-in tools for gathering knowledge and generating code, but agents may still need to complete specific tasks or actions that an AI model cannot reliably handle alone. Custom tools let you add functionality based on your own code or a third-party service/API so the agent can take those actions.

Example scenario described: a retail company builds a custom FAQ agent and provides custom tools to look up customer orders (so support staff can focus on complex issues).

## Why use custom tools
Custom tools help businesses by:
- Enhanced productivity: automate repetitive tasks and streamline workflows specific to the use case.
- Improved accuracy: produce precise and consistent outputs and reduce human error.
- Tailored solutions: address specific business needs and optimize processes.
Tools make custom functionality available for the agent to use depending on how it decides to respond to a prompt (example given: calling a weather tool/API to answer a question about ski resort conditions).

## Common scenarios for custom tools (examples listed)
- Customer support automation: connect to CRM to retrieve order history, process refunds, provide real-time shipping updates.
- Inventory management: link to inventory system, check stock, predict restocking using historical data, place supplier orders automatically.
- Healthcare appointment scheduling: access patient records, suggest appointment slots, send reminders.
- IT helpdesk support: integrate with ticketing + knowledge base, troubleshoot, escalate, track ticket status.
- E-learning and training: connect to LMS, recommend courses, track progress, answer course questions.

# Options for implementing custom tools

## Custom tool options in Foundry Agent Service
Foundry Agent Service provides several custom tool options:
- Custom function (function calling): describe function structures to the agent; agent returns which functions to call and arguments; agent can identify appropriate functions from definitions; supports integrating custom logic/workflows in multiple programming languages.
- Azure Functions: serverless, event-driven apps with triggers and bindings (triggers control when it runs; bindings connect to input/output data sources).
- OpenAPI specification tools: connect an agent to an external API using an OpenAPI 3.0 spec; specs describe HTTP APIs and help people understand APIs, generate client code, create tests, and apply design standards.
- Azure Logic Apps: low-code/no-code workflows connecting apps, data, and services.

# How to integrate custom tools

## Function calling (what it is)
Function calling enables agents to execute predefined functions dynamically based on user input. Itâ€™s used when agents need to perform specific tasks (retrieving data, processing queries). Functions may call other APIs or initiate programs.

### Example (function definition)
The module shows a sample function (snowfall tracking) in Python and registering it so the agent can call it dynamically.

Function definition shown: `def recent_snowfall(location: str) -> str: ... return json.dumps({...})`

Registration pattern shown (concepts):
- build a `FunctionTool` from a set of user functions
- add to a `ToolSet`
- enable auto function calling
- create the agent with the toolset

Relevant code/commands:
- `pip install ...` (not shown in this module section)
- `def recent_snowfall(location: str) -> str: ...`
- `functions = FunctionTool(user_functions)`
- `toolset = ToolSet(); toolset.add(functions)`
- `agent_client.enable_auto_function_calls(toolset=toolset)`
- `agent = agent_client.create_agent(..., toolset=toolset)`

## Azure Functions (what it is)
Azure Functions provide serverless compute for real-time processing and event-driven workflows. Agents can respond to triggers like HTTP requests or queue messages.

### Example (queue trigger integration)
The module shows adding an Azure Function tool to the agent definition using storage queues (input/output). The agent sends requests via a storage queue and processes the results.

Relevant code/commands:
- `azure_function_tool = AzureFunctionTool(...)`
- `input_queue=AzureFunctionStorageQueue(queue_name="input", ...)`
- `output_queue=AzureFunctionStorageQueue(queue_name="output", ...)`
- `agent = agent_client.create_agent(..., tools=azure_function_tool.definitions)`

## OpenAPI Specification tools (what it is)
OpenAPI tools let agents call external APIs using standardized OpenAPI 3.0 specs. This simplifies integration and promotes compatibility across services.

Auth types supported (as stated):
- anonymous
- API key
- managed identity

### Example (OpenAPI spec file + registration)
The module shows creating a JSON OpenAPI 3.0 spec file (example: snowfall_openapi.json) describing an endpoint and then registering it as an OpenAPI tool.

Relevant code/commands:
- Create JSON file `snowfall_openapi.json` with OpenAPI 3.0 structure
- `openapi_spec = json.load(f)`
- `auth = OpenApiAnonymousAuthDetails()`
- `openapi_tool = OpenApiTool(name="...", spec=openapi_spec, auth=auth)`
- `agent = agent_client.create_agent(..., tools=[openapi_tool])`

## Declarative nature of tools (important concept)
You do not write code that explicitly calls the custom tool functions. The agent decides when to call tools based on messages in prompts. Meaningful function names and well-documented parameters help the agent decide when and how to call the function.

# Module assessment answers

## Q1: What are custom tools, and how can they help you develop effective agents with Microsoft Foundry Agent Service?
Answer: Callable functions that an agent can use to extend its capabilities.

## Q2: You need to integrate functionality from an OpenAPI 3.0-based web service into an agent solution. What should you do?
Answer: Add the web service as an OpenAPI specification tool to the agent definition.

## Q3: Your agent application code includes a local function that you want the agent to call. What kind of tool should you add to the agent's definition?
Answer: Function calling
